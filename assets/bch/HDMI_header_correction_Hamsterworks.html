<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" dir="ltr">
<head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app225.us.archive.org';v.server_ms=401;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="/_static/js/bundle-playback.js?v=1WaXNDFE" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=txqj7nKC" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="/_static/js/ruffle.js"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("http://hamsterworks.co.nz:80/mediawiki/index.php/HDMI_header_error_correction","20191021164243","https://web.archive.org/","web","/_static/",
	      "1571676163");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=S1zqJCYt" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->

<title>HDMI header error correction - Hamsterworks Wiki!</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="MediaWiki 1.16.2"/>
<link rel="shortcut icon" href="/web/20191021164243im_/http://hamsterworks.co.nz/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/opensearch_desc.php" title="Hamsterworks Wiki! (en)"/>
<link rel="alternate" type="application/atom+xml" title="Hamsterworks Wiki! Atom feed" href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<link rel="stylesheet" href="/web/20191021164243cs_/http://hamsterworks.co.nz/mediawiki/skins/common/shared.css?270" media="screen"/>
<link rel="stylesheet" href="/web/20191021164243cs_/http://hamsterworks.co.nz/mediawiki/skins/common/commonPrint.css?270" media="print"/>
<link rel="stylesheet" href="/web/20191021164243cs_/http://hamsterworks.co.nz/mediawiki/skins/monobook/main.css?270" media="screen"/>
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/mediawiki/skins/monobook/IE50Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/mediawiki/skins/monobook/IE55Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/mediawiki/skins/monobook/IE60Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/mediawiki/skins/monobook/IE70Fixes.css?270" media="screen" /><![endif]-->
<link rel="stylesheet" href="/web/20191021164243cs_/http://hamsterworks.co.nz/mediawiki/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000"/>
<link rel="stylesheet" href="/web/20191021164243cs_/http://hamsterworks.co.nz/mediawiki/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" media="print"/>
<link rel="stylesheet" href="/web/20191021164243cs_/http://hamsterworks.co.nz/mediawiki/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000"/>
<link rel="stylesheet" href="/web/20191021164243cs_/http://hamsterworks.co.nz/mediawiki/index.php?title=-&amp;action=raw&amp;maxage=18000&amp;gen=css"/>
<script>
var skin="monobook",
stylepath="/mediawiki/skins",
wgUrlProtocols="http\\:\\/\\/|https\\:\\/\\/|ftp\\:\\/\\/|irc\\:\\/\\/|gopher\\:\\/\\/|telnet\\:\\/\\/|nntp\\:\\/\\/|worldwind\\:\\/\\/|mailto\\:|news\\:|svn\\:\\/\\/",
wgArticlePath="/mediawiki/index.php/$1",
wgScriptPath="/mediawiki",
wgScriptExtension=".php",
wgScript="/mediawiki/index.php",
wgVariantArticlePath=false,
wgActionPaths={},
wgServer="https://web.archive.org/web/20191021164243/http://hamsterworks.co.nz",
wgCanonicalNamespace="",
wgCanonicalSpecialPageName=false,
wgNamespaceNumber=0,
wgPageName="HDMI_header_error_correction",
wgTitle="HDMI header error correction",
wgAction="view",
wgArticleId=828,
wgIsArticle=true,
wgUserName=null,
wgUserGroups=null,
wgUserLanguage="en",
wgContentLanguage="en",
wgBreakFrames=false,
wgCurRevisionId=5662,
wgVersion="1.16.2",
wgEnableAPI=true,
wgEnableWriteAPI=true,
wgSeparatorTransformTable=["", ""],
wgDigitTransformTable=["", ""],
wgMainPageTitle="Main Page",
wgFormattedNamespaces={"-2": "Media", "-1": "Special", "0": "", "1": "Talk", "2": "User", "3": "User talk", "4": "Hamsterworks Wiki!", "5": "Hamsterworks Wiki! talk", "6": "File", "7": "File talk", "8": "MediaWiki", "9": "MediaWiki talk", "10": "Template", "11": "Template talk", "12": "Help", "13": "Help talk", "14": "Category", "15": "Category talk"},
wgNamespaceIds={"media": -2, "special": -1, "": 0, "talk": 1, "user": 2, "user_talk": 3, "hamsterworks_wiki!": 4, "hamsterworks_wiki!_talk": 5, "file": 6, "file_talk": 7, "mediawiki": 8, "mediawiki_talk": 9, "template": 10, "template_talk": 11, "help": 12, "help_talk": 13, "category": 14, "category_talk": 15, "image": 6, "image_talk": 7},
wgSiteName="Hamsterworks Wiki!",
wgCategories=[],
wgRestrictionEdit=[],
wgRestrictionMove=[];
</script><script src="/web/20191021164243js_/http://hamsterworks.co.nz/mediawiki/skins/common/wikibits.js?270"></script>
<script src="/web/20191021164243js_/http://hamsterworks.co.nz/mediawiki/skins/common/ajax.js?270"></script>
<script src="/web/20191021164243js_/http://hamsterworks.co.nz/mediawiki/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook&amp;270"></script>

</head>
<body class="mediawiki ltr ns-0 ns-subject page-HDMI_header_error_correction skin-monobook"><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20191021164243/http%3A//hamsterworks.co.nz/mediawiki/index.php/HDMI_header_error_correction"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://hamsterworks.co.nz/mediawiki/index.php/HDMI_header_error_correction" onfocus="this.focus();this.select();" style="flex:1;"/><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20191021164243" /><input type="submit" value="Go" />
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
                <div class="s" id="wm-nav-captures" style="flex:1;">
                    <a class="t" href="/web/20191021164243*/http://hamsterworks.co.nz/mediawiki/index.php/HDMI_header_error_correction" title="See a list of every capture for this URL">19 captures</a>
          <div class="r" title="Timespan for captures of this URL">07 Jul 2018 - 20 Nov 2019</div>
          </div>
        <div class="k">
          <a href="" id="wm-graph-anchor">
            <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
              <canvas id="wm-sparkline-canvas" width="700" height="27" border="0"></canvas>
            </div>
          </a>
        </div>
      </div>
    </div>
    <div class="n">
      <table>
        <tbody>
          <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
          <tr class="m">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20190822225004/http://hamsterworks.co.nz:80/mediawiki/index.php/HDMI_header_error_correction" title="22 Aug 2019"><strong>Aug</strong></a></td>
            <td class="c" id="displayMonthEl" title="You are here: 16:42:43 Oct 21, 2019">OCT</td>
            <td class="f" nowrap="nowrap">Nov</td>
          </tr>
          <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
          <tr class="d">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20190922173913/http://hamsterworks.co.nz:80/mediawiki/index.php/HDMI_header_error_correction" title="17:39:13 Sep 22, 2019"><img src="/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
            <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 16:42:43 Oct 21, 2019">21</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20191120233811/http://hamsterworks.co.nz:80/mediawiki/index.php/HDMI_header_error_correction" title="23:38:11 Nov 20, 2019"><img src="/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
          </tr>
          <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
          <tr class="y">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20181009033616/http://hamsterworks.co.nz:80/mediawiki/index.php/HDMI_header_error_correction" title="09 Oct 2018"><strong>2018</strong></a></td>
            <td class="c" id="displayYearEl" title="You are here: 16:42:43 Oct 21, 2019">2019</td>
            <td class="f" nowrap="nowrap">2020</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
                <span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#" title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
        </span>
                <a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
        <a id="wm-tb-close" href="#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="/web/20191021164243/http://web.archive.org/screenshot/http://hamsterworks.co.nz/mediawiki/index.php/HDMI_header_error_correction"
           id="wm-screenshot"
           title="screenshot">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
        <a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20191021164243/http://hamsterworks.co.nz:80/mediawiki/index.php/HDMI_header_error_correction" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
        <a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20191021164243/http://hamsterworks.co.nz:80/mediawiki/index.php/HDMI_header_error_correction" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
        <a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
        <div id="wm-capinfo-notice" source="api"></div>
                <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/alexacrawls)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/alexacrawls" target="_new"><span class="wm-title">Alexa Crawls</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  Starting in 1996, <a href="http://www.alexa.com/">Alexa Internet</a> has been donating their crawl data to the Internet Archive.  Flowing in every day, these data are added to the <a href="http://web.archive.org/">Wayback Machine</a> after an embargo period.
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20191021164243/http://hamsterworks.co.nz:80/mediawiki/index.php/HDMI_header_error_correction</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(700,27,25,2,"web","http://hamsterworks.co.nz/mediawiki/index.php/HDMI_header_error_correction","20191021164243",1996,"/_static/",["/_static/css/banner-styles.css?v=S1zqJCYt","/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading">HDMI header error correction</h1>
	<div id="bodyContent">
		<h3 id="siteSub">From Hamsterworks Wiki!</h3>
		<div id="contentSub"></div>
		<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>
		<!-- start content -->
<p>This <a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/FPGA_Projects" title="FPGA Projects">FPGA Project</a> was started in June 2018
</p><p>I've been wondering about how Bose–Chaudhuri–Hocquenghem codes work. I know that the are used in the HDMI data packets to correct errors, but original HDMI projects ignored them - I had no idea how they actually work.
</p><p>The description on Wikipedia ( <a href="https://web.archive.org/web/20191021164243/https://en.wikipedia.org/wiki/BCH_code" class="external free" rel="nofollow">https://en.wikipedia.org/wiki/BCH_code</a> ) is impenetrable to me, and most of the information on the web is about more advanced applications, designed to allow multi-bit errors to be corrected.
</p><p>I want to add ECC of the data packets to my HDMI projects, so tried to figure it all out.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#So_what_is_really_going_on.3F"><span class="tocnumber">1</span> <span class="toctext">So what is really going on?</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Why_can.27t_BCH.2832.2C24.29_fix_multi-bit_errors.3F"><span class="tocnumber">2</span> <span class="toctext">Why can't BCH(32,24) fix multi-bit errors?</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#An_example_of_an_impractical_multi-bit_BCH_code"><span class="tocnumber">3</span> <span class="toctext">An example of an impractical multi-bit BCH code</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Source"><span class="tocnumber">4</span> <span class="toctext">Source</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#bch_correction_32bit_frame.vhd"><span class="tocnumber">4.1</span> <span class="toctext">bch_correction_32bit_frame.vhd</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#bch_correction_64bit_frame.vhd"><span class="tocnumber">4.2</span> <span class="toctext">bch_correction_64bit_frame.vhd</span></a></li>
</ul>
</li>
</ul>
</td></tr></table><script>if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<h2> <span class="mw-headline" id="So_what_is_really_going_on.3F"> So what is really going on? </span></h2>
<p>You can either look at the code used as a cyclic redundancy check, based around an 8-bit Linear Feedback Shift Register. This doesn't give any insight into how you can efficiently use them to correct errors.
</p><p>A better way to look at the is this:
</p><p>Each of the 24 data bits cause a different data bit to be XORed into the final parity.
</p>
<pre>
Checksum
7      0 23       data bits       0
10000011 10000000 00000000 00000000
11000010 01000000 00000000 00000000
01100001 00100000 00000000 00000000
10110011 00010000 00000000 00000000
11011010 00001000 00000000 00000000
01101101 00000100 00000000 00000000
10110101 00000010 00000000 00000000
11011001 00000001 00000000 00000000
11101111 00000000 10000000 00000000
11110100 00000000 01000000 00000000
01111010 00000000 00100000 00000000
00111101 00000000 00010000 00000000
10011101 00000000 00001000 00000000
11001101 00000000 00000100 00000000
11100101 00000000 00000010 00000000
11110001 00000000 00000001 00000000
11111011 00000000 00000000 10000000
11111110 00000000 00000000 01000000
01111111 00000000 00000000 00100000
10111100 00000000 00000000 00010000
01011110 00000000 00000000 00001000
00101111 00000000 00000000 00000100
10010100 00000000 00000000 00000010
01001010 00000000 00000000 00000001

</pre>
<p>In the literature, the parity of a signal bit is called a "syndrome". If that bit is changed, the 'syndrome' is what you will see when you compare (XOR) the received and computed parity values.
</p><p>The BCH code is constructed so that the parity of the parity bits are sort of their own parity. If these bits get corrupted, the checksum process will point directly at them. So the syndrome for parity bit 0 is 00000001, for bit 1 is 00000010, and so on.
</p><p>The solving process for these simple codes is simple:
</p>
<ol><li> Recalculate the parity bits of the data
</li><li> XOR the parity from the received data and the freshly computed parity 
</li><li> If the result of the XOR is zero, then you have no error
</li><li> You can either use a lookup table to see what causes that syndrome, or calculate which bit has that syndrome.
</li><li> If it isn't one of the syndromes then it is a multi-bit error
</li></ol>
<h2> <span class="mw-headline" id="Why_can.27t_BCH.2832.2C24.29_fix_multi-bit_errors.3F"> Why can't BCH(32,24) fix multi-bit errors? </span></h2>
<p>Simply put, there isn't enough parity - there is over 480 different double-bit errors, but only 256 different possible error patterns so the error can not be conclusively identified.
</p><p>How does the math work for this? 
</p><p>If two bit flips occur then then error is the two syndromes XORed together. So if bits 0 and 1 were flipped to, then the error will be 10010100 XOR 01001010 = 11011110. 
However, that is the same error you get if bit 6 and parity bit 5 is flipped as 11111110 XOR 00100000 = 11011110. That is the reason why BCH(32,24) can detect multi-bit errors, but can only correct a single bit error.
</p><p>Some BCH codes with more parity bits can detect and correct multi-bit errors - it can be solved efficiently by using math to 'factor' the error pattern into individual syndromes.
</p>
<h2> <span class="mw-headline" id="An_example_of_an_impractical_multi-bit_BCH_code"> An example of an impractical multi-bit BCH code </span></h2>
<p>Say only want to transmit one bit - a somewhat important bit - and it is a very noisy channel, one with a 20% chance of error on each bit.
</p><p>Add 6 parity bits to the single data bit, and then you have two codewords - either 0000000 or 1111111. On reception of a garbled codeword you can correct up to 3 errors, and have better than a 99% chance of correctly receiving the data.
</p>
<h2> <span class="mw-headline" id="Source"> Source </span></h2>
<h3> <span class="mw-headline" id="bch_correction_32bit_frame.vhd"> bch_correction_32bit_frame.vhd </span></h3>
<pre>
-------------------------------------------------------------------------------
-- bch_correction_32bit_frame.vhd
-- 
-- Author: Mike Field &lt;hamster@snap.net.nz&gt;
--
-- Perform the BHC(32,24) ECC code used in the HDMI data islands. The 
-- 32 bits of data is streamed in, with start_of_frame asserted during 
-- the first data bit
--
-- The corrected data is streamed out, with any single-bit errors
-- corrected. o_valid frame is asserted when the resulting data packet
-- no pass validation (i.e. does not have multiple bit errors)
--
-- Approximate simulation waveforms:
--
-- Inputs:
--   i_data_bit       :  --ddddddddddddddddddddddddpppppppp------------------------------------------------------------------
--   i_start_of_frame :  --10000000000000000000000000000000------------------------------------------------------------------
-- Outputs:
--   o_data_bit       :  ----------------------------------------------------------------ddddddddddddddddddddddddpppppppp----
--   o_valid_frame    :  ----------------------------------------------------------------10000000000000000000000000000000----
--   o_start_of_frame :  ----------------------------------------------------------------V0000000000000000000000000000000----
--
--    d = data bit, p = parity bit, V = generated 'frame valid' bit.
--
-- If no &quot;valid frame&quot; signal is required, then the latency can be reduced 
-- by shortening (or even removing) the &quot;corrected_(data|start)_shift registers
--
-- Resoruces (Xilinx Spartan 6):
--   Flipflops   : 32
--   LUTS        : 24
--
-------------------------------------------------------------------------------

library IEEE;
use IEEE.STD_LOGIC_1164.ALL;

entity bch_correction_32bit_frame is
    Port ( clk              : in   STD_LOGIC;
           i_data_bit       : in   STD_LOGIC;
           i_start_of_frame : in   STD_LOGIC;
           o_data_bit       : out  STD_LOGIC;
           o_valid_frame    : out  STD_LOGIC;
           o_start_of_frame : out  STD_LOGIC);
end bch_correction_32bit_frame;

architecture Behavioral of bch_correction_32bit_frame is
  signal error_shift_reg           : std_logic_vector( 7 downto 0)  := (others =&gt; '0');
  signal parity_shift_reg          : std_logic_vector( 7 downto 0)  := (others =&gt; '0');
  signal original_data_shift_reg   : std_logic_vector(32 downto 0)  := (others =&gt; '0');
  signal start_shift_reg           : std_logic_vector(32 downto 0)  := (others =&gt; '0');
  signal corrected_data_shift_reg  : std_logic_vector(30 downto 0)  := (others =&gt; '0');
  signal corrected_start_shift_reg : std_logic_vector(30 downto 0)  := (others =&gt; '0');
begin

process(clk) 
   begin
      if rising_edge(clk) then
         ---------------------------------------------------------
         -- Output the data - it is only balid when the 'error' 
			-- reg is either zero, or the 31st bit will be corrected
         ---------------------------------------------------------
         if error_shift_reg = x&quot;00&quot; or error_shift_reg = x&quot;4A&quot; then
            o_valid_frame    &lt;= corrected_start_shift_reg(0);
         else
            o_valid_frame    &lt;= '0';
         end if;
         o_data_bit       &lt;= corrected_data_shift_reg(0);
         o_start_of_frame &lt;= corrected_start_shift_reg(0);
		
         ---------------------------------------------------------
         -- Where the error correction actually happens
         ---------------------------------------------------------
         if error_shift_reg = x&quot;4A&quot; then
            corrected_data_shift_reg &lt;= (not original_data_shift_reg(0)) &amp; corrected_data_shift_reg(corrected_data_shift_reg'high downto 1);
            error_shift_reg &lt;= (others =&gt; '0');
         else
            corrected_data_shift_reg &lt;= original_data_shift_reg(0) &amp; corrected_data_shift_reg(corrected_data_shift_reg'high downto 1);

            ---------------------------------------------------------
	    -- Reversing the encoding LFSR one bit
            ---------------------------------------------------------
            if error_shift_reg(0) = '1' then 
               error_shift_reg &lt;= (&quot;0&quot; &amp; error_shift_reg(7 downto 1)) XOR x&quot;83&quot;;
            else
               error_shift_reg &lt;= &quot;0&quot; &amp; error_shift_reg(7 downto 1);
            end if;
         end if;
         corrected_start_shift_reg &lt;= start_shift_reg(0) &amp; corrected_start_shift_reg(corrected_start_shift_reg'high downto 1);

         -----------------------------------------------------------------------
         -- Have we seen enough data that we can calculate the parity error?
         -----------------------------------------------------------------------
         if start_shift_reg(start_shift_reg'high-31) = '1' then
            error_shift_reg &lt;= parity_shift_reg xor original_data_shift_reg(original_data_shift_reg'high downto original_data_shift_reg'high-7);
         end if;

         -----------------------------------------------------------------------
         -- Calculating the parity of the incoming data, but use bits that are
         -- seven bits old 
         -----------------------------------------------------------------------
         if start_shift_reg(start_shift_reg'high-7) = '1' then 
			   -- Startng a new parity calculation
            if original_data_shift_reg(original_data_shift_reg'high-7) = '1' then
               parity_shift_reg &lt;= x&quot;83&quot;;    
            else
               parity_shift_reg &lt;= x&quot;00&quot;;    
            end if;
         else
            -- Adding the next bit into the current parity calculations
            if (original_data_shift_reg(original_data_shift_reg'high-7) xor parity_shift_reg(0))  = '1' then
               parity_shift_reg &lt;= (&quot;0&quot; &amp; parity_shift_reg(7 downto 1)) XOR x&quot;83&quot;;
            else
               parity_shift_reg &lt;= (&quot;0&quot; &amp; parity_shift_reg(7 downto 1));
            end if;     
         end if;
         -----------------------------------------------------------------------
         -- Moving data through the shift registers			
         -----------------------------------------------------------------------
	 original_data_shift_reg  &lt;= i_data_bit       &amp; original_data_shift_reg(original_data_shift_reg 'high downto 1);
	 start_shift_reg          &lt;= i_start_of_frame &amp; start_shift_reg(start_shift_reg 'high downto 1);
      end if;     
   end process;
end Behavioral;

</pre>
<h3> <span class="mw-headline" id="bch_correction_64bit_frame.vhd"> bch_correction_64bit_frame.vhd </span></h3>
<p>I also need to code the ECC process for the 64-bit data frames, that are received two bits at a time.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 41/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key bitnami_mediawiki:pcache:idhash:828-0!1!0!!en!2!edit=0 and timestamp 20191020181837 -->
<div class="printfooter">
Retrieved from "<a href="https://web.archive.org/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/HDMI_header_error_correction">http://hamsterworks.co.nz/mediawiki/index.php/HDMI_header_error_correction</a>"</div>
		<div id="catlinks" class="catlinks catlinks-allhidden"></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				 <li id="ca-nstab-main" class="selected"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/HDMI_header_error_correction" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php?title=Talk:HDMI_header_error_correction&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php?title=HDMI_header_error_correction&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php?title=HDMI_header_error_correction&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php?title=Special:UserLogin&amp;returnto=HDMI_header_error_correction" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/web/20191021164243im_/http://hamsterworks.co.nz/mediawiki/skins/common/images/hamsterworks.png);" href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Main_Page" title="Visit the main page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class="pBody">
			<ul>
				<li id="n-mainpage-description"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-portal"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Hamsterworks_Wiki!:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-currentevents"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Hamsterworks_Wiki!:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Help:Contents" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php" id="searchform">
				<input type="hidden" name="title" value="Special:Search"/>
				<input id="searchInput" title="Search Hamsterworks Wiki!" accesskey="f" type="search" name="search"/>
				<input type="submit" name="go" class="searchButton" id="searchGoButton" value="Go" title="Go to a page with this exact name if exists"/>&nbsp;
				<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text"/>
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Special:WhatLinksHere/HDMI_header_error_correction" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Special:RecentChangesLinked/HDMI_header_error_correction" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php?title=HDMI_header_error_correction&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php?title=HDMI_header_error_correction&amp;oldid=5662" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico"><a href="https://web.archive.org/web/20191021164243/http://www.mediawiki.org/"><img src="/web/20191021164243im_/http://hamsterworks.co.nz/mediawiki/skins/common/images/poweredby_mediawiki_88x31.png" height="31" width="88" alt="Powered by MediaWiki"/></a></div>
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 31 August 2018, at 07:45.</li>
		<li id="viewcount">This page has been accessed 6,550 times.</li>
		<li id="privacy"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Hamsterworks_Wiki!:Privacy_policy" title="Hamsterworks Wiki!:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Hamsterworks_Wiki!:About" title="Hamsterworks Wiki!:About">About Hamsterworks Wiki!</a></li>
		<li id="disclaimer"><a href="/web/20191021164243/http://hamsterworks.co.nz/mediawiki/index.php/Hamsterworks_Wiki!:General_disclaimer" title="Hamsterworks Wiki!:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>

<script>if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.264 secs. --></body></html>
<!--
     FILE ARCHIVED ON 16:42:43 Oct 21, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 05:57:54 Sep 11, 2023.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 139.252 (11)
  exclusion.robots: 0.182
  exclusion.robots.policy: 0.17
  cdx.remote: 0.065
  esindex: 0.011
  LoadShardBlock: 113.39 (3)
  PetaboxLoader3.datanode: 183.934 (4)
  load_resource: 252.882
  PetaboxLoader3.resolve: 169.444
-->