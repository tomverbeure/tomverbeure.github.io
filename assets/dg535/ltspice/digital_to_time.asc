Version 4.1
SHEET 1 1240 680
WIRE 400 -1216 -288 -1216
WIRE 208 -1136 192 -1136
WIRE 240 -1136 208 -1136
WIRE -288 -1120 -288 -1216
WIRE -1024 -1104 -1056 -1104
WIRE -976 -1104 -1024 -1104
WIRE -880 -1104 -912 -1104
WIRE -832 -1104 -880 -1104
WIRE -736 -1104 -768 -1104
WIRE -688 -1104 -736 -1104
WIRE -608 -1104 -640 -1104
WIRE -560 -1104 -608 -1104
WIRE 240 -1104 240 -1136
WIRE 240 -1104 48 -1104
WIRE 240 -1072 240 -1104
WIRE -1056 -1056 -1056 -1104
WIRE -912 -1056 -912 -1104
WIRE -768 -1056 -768 -1104
WIRE -640 -1056 -640 -1104
WIRE 48 -1008 48 -1104
WIRE -288 -992 -288 -1040
WIRE -208 -992 -288 -992
WIRE -96 -992 -144 -992
WIRE -352 -976 -368 -976
WIRE -320 -976 -352 -976
WIRE 240 -944 240 -992
WIRE 400 -944 400 -1216
WIRE 400 -944 240 -944
WIRE -368 -928 -368 -976
WIRE -1056 -912 -1056 -976
WIRE -912 -912 -912 -976
WIRE -768 -912 -768 -976
WIRE -640 -912 -640 -976
WIRE -176 -912 -208 -912
WIRE -160 -912 -176 -912
WIRE 240 -880 240 -944
WIRE -208 -864 -208 -912
WIRE -288 -848 -288 -992
WIRE -240 -848 -288 -848
WIRE -96 -832 -96 -992
WIRE -96 -832 -176 -832
WIRE -64 -832 -96 -832
WIRE 48 -832 48 -944
WIRE 48 -832 16 -832
WIRE 64 -832 48 -832
WIRE 176 -832 144 -832
WIRE -432 -816 -480 -816
WIRE -368 -816 -368 -864
WIRE -368 -816 -432 -816
WIRE -240 -816 -368 -816
WIRE -480 -784 -480 -816
WIRE -208 -752 -208 -800
WIRE -176 -752 -208 -752
WIRE -160 -752 -176 -752
WIRE 240 -736 240 -784
WIRE -480 -656 -480 -704
WIRE 240 -576 240 -656
WIRE 240 -576 176 -576
WIRE 304 -576 240 -576
WIRE 176 -496 176 -576
WIRE 304 -496 304 -576
WIRE -816 -448 -880 -448
WIRE -432 -448 -816 -448
WIRE -16 -448 -432 -448
WIRE 112 -448 64 -448
WIRE 448 -448 368 -448
WIRE -880 -400 -880 -448
WIRE -672 -336 -784 -336
WIRE -336 -336 -672 -336
WIRE -16 -336 -336 -336
WIRE 448 -336 448 -448
WIRE 448 -336 64 -336
WIRE 832 -336 752 -336
WIRE -880 -304 -880 -320
WIRE -784 -288 -784 -336
WIRE 752 -288 752 -336
WIRE -432 -272 -432 -448
WIRE -336 -272 -336 -336
WIRE 176 -272 176 -400
WIRE 176 -272 80 -272
WIRE 832 -256 832 -336
WIRE 80 -240 80 -272
WIRE 688 -240 640 -240
WIRE 688 -208 688 -240
WIRE 752 -208 688 -208
WIRE 688 -192 688 -208
WIRE -784 -176 -784 -208
WIRE 176 -176 176 -272
WIRE 304 -176 304 -400
WIRE -432 -160 -432 -192
WIRE -336 -160 -336 -192
WIRE -336 -160 -432 -160
WIRE 80 -128 80 -160
WIRE 96 -128 80 -128
WIRE 832 -128 832 -176
WIRE 912 -128 832 -128
WIRE 1056 -128 912 -128
WIRE 1136 -128 1056 -128
WIRE -432 -96 -432 -160
WIRE -400 -96 -432 -96
WIRE -368 -96 -400 -96
WIRE 912 -96 912 -128
WIRE 128 -80 -208 -80
WIRE -32 -48 -144 -48
WIRE 80 -48 -32 -48
WIRE -608 -16 -784 -16
WIRE -32 -16 -32 -48
WIRE -144 0 -144 -48
WIRE 80 0 80 -48
WIRE 80 0 48 0
WIRE 912 16 912 -16
WIRE 944 16 912 16
WIRE 960 16 944 16
WIRE 640 32 640 -240
WIRE 832 32 832 -128
WIRE -672 48 -704 48
WIRE -656 48 -672 48
WIRE -208 48 -208 -80
WIRE -112 48 -208 48
WIRE -704 80 -704 48
WIRE 128 80 128 -80
WIRE 128 80 48 80
WIRE 208 80 128 80
WIRE 304 80 304 -96
WIRE 304 80 288 80
WIRE 368 80 304 80
WIRE 400 80 368 80
WIRE 448 80 400 80
WIRE 576 80 528 80
WIRE 928 80 896 80
WIRE 1024 80 1008 80
WIRE 1040 80 1024 80
WIRE 1168 80 1120 80
WIRE -784 96 -784 -16
WIRE -736 96 -784 96
WIRE -608 112 -608 -16
WIRE -608 112 -672 112
WIRE -560 112 -608 112
WIRE -416 112 -480 112
WIRE -288 112 -416 112
WIRE -112 112 -288 112
WIRE 1168 112 1168 80
WIRE -816 128 -864 128
WIRE -736 128 -816 128
WIRE 304 128 304 80
WIRE 368 128 368 80
WIRE 1024 128 1024 80
WIRE -416 160 -416 112
WIRE -864 176 -864 128
WIRE -288 176 -288 112
WIRE 16 176 16 160
WIRE 176 176 176 -96
WIRE 176 176 16 176
WIRE 640 176 640 128
WIRE 720 176 640 176
WIRE 832 176 832 128
WIRE 832 176 720 176
WIRE -704 192 -704 144
WIRE -672 192 -704 192
WIRE -656 192 -672 192
WIRE -32 208 -32 160
WIRE 1024 224 1024 192
WIRE 1168 224 1168 192
WIRE 1168 224 1024 224
WIRE 304 240 304 192
WIRE 336 240 304 240
WIRE 352 240 336 240
WIRE -416 272 -416 240
WIRE 368 272 368 192
WIRE 1168 272 1168 224
WIRE -864 320 -864 256
WIRE -32 320 -32 288
WIRE 720 336 720 256
WIRE 752 336 720 336
WIRE 768 336 752 336
WIRE -416 368 -416 352
WIRE -288 368 -288 240
WIRE -288 368 -416 368
WIRE -416 384 -416 368
FLAG -144 0 0
FLAG -32 320 0
FLAG -864 320 0
FLAG 368 272 0
FLAG -816 -448 A_CNT
FLAG -432 -816 A_CAL
FLAG -480 -656 0
FLAG -912 -912 0
FLAG -880 -1104 -15
FLAG -176 -912 +15
FLAG -1056 -912 0
FLAG -1024 -1104 +15
FLAG -176 -752 -15
FLAG -352 -976 +15
FLAG 208 -1136 +15
FLAG -816 128 A_ADJ
FLAG 400 80 v_cap
FLAG -672 -336 A_CNT_
FLAG -880 -304 0
FLAG -784 -176 0
FLAG 80 -128 -15
FLAG -672 48 +15
FLAG -672 192 -15
FLAG -416 384 0
FLAG 752 336 -15
FLAG 688 -192 0
FLAG 1168 272 0
FLAG 944 16 -2
FLAG -768 -912 0
FLAG -736 -1104 -2
FLAG -400 -96 -2
FLAG 1056 -128 Output
FLAG -640 -912 0
FLAG -608 -1104 -5.2
FLAG 336 240 -5.2
SYMBOL LM13700_NS -32 80 R0
WINDOW 0 0 9 Bottom 2
WINDOW 3 -101 85 Top 2
SYMATTR InstName U1
SYMBOL voltage -32 192 R0
SYMATTR InstName V1
SYMATTR Value -15
SYMBOL voltage -864 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value {A_ADJ}
SYMBOL res 304 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 330
SYMBOL cap 352 128 R0
SYMATTR InstName C1
SYMATTR Value 100p
SYMBOL diode 288 128 R0
WINDOW 3 -82 68 Left 2
SYMATTR Value 1N4148
SYMATTR InstName D1
SYMBOL res 64 -256 R0
SYMATTR InstName R2
SYMATTR Value 220
SYMBOL res 160 -192 R0
SYMATTR InstName R3
SYMATTR Value 2.2k
SYMBOL pnp 368 -400 R180
WINDOW 0 36 44 Left 2
WINDOW 3 -83 101 Left 2
SYMATTR InstName Q1
SYMATTR Value 2N3906
SYMBOL pnp 112 -400 M180
WINDOW 0 30 49 Left 2
WINDOW 3 -75 106 Left 2
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL res 80 -464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 47
SYMBOL res 288 -192 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL res 544 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 47
SYMBOL res 80 -352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 47
SYMBOL res -448 -288 R0
SYMATTR InstName R8
SYMATTR Value 100
SYMBOL res -352 -288 R0
SYMATTR InstName R9
SYMATTR Value 100
SYMBOL OpAmps\\opamp2 -208 -896 R0
SYMATTR InstName U2
SYMATTR Value LF347
SYMBOL voltage -480 -800 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 2.5
SYMBOL voltage -912 -1072 R0
SYMATTR InstName V8
SYMATTR Value -15
SYMBOL voltage -1056 -1072 R0
SYMATTR InstName V9
SYMATTR Value +15
SYMBOL cap -384 -928 R0
SYMATTR InstName C2
SYMATTR Value 0.1µ
SYMBOL res -304 -1136 R0
SYMATTR InstName R10
SYMATTR Value 100k
SYMBOL cap -144 -1008 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 100p
SYMBOL res 32 -848 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 160 -848 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 47
SYMBOL pnp 176 -784 M180
SYMATTR InstName Q3
SYMATTR Value 2N3906
SYMBOL res 224 -1088 R0
SYMATTR InstName R13
SYMATTR Value 909
SYMBOL cap 32 -1008 R0
SYMATTR InstName C4
SYMATTR Value 0.1µ
SYMBOL voltage -880 -416 R0
WINDOW 3 -44 -90 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V10
SYMATTR Value PULSE(-1.6 -0.8 0 10p 10p 100n 1500n)
SYMBOL bv -784 -304 R0
SYMATTR InstName B1
SYMATTR Value V=-(V(A_CNT)+1.2)-1.2
SYMBOL res 224 -752 R0
SYMATTR InstName R14
SYMATTR Value 1µ
SYMBOL OpAmps\\opamp2 -704 48 R0
SYMATTR InstName U3
SYMATTR Value LF347
SYMBOL res -464 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 4.02k
SYMBOL res -432 144 R0
SYMATTR InstName R16
SYMATTR Value 1k
SYMBOL voltage -416 256 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value -10.7
SYMBOL cap -304 176 R0
SYMATTR InstName C5
SYMATTR Value 0.1µ
SYMBOL npn 576 32 R0
SYMATTR InstName Q4
SYMATTR Value 2N2222
SYMBOL npn 896 32 M0
SYMATTR InstName Q5
SYMATTR Value 2N2222
SYMBOL res 704 160 R0
SYMATTR InstName R17
SYMATTR Value 920
SYMBOL res 816 -272 R0
SYMATTR InstName R18
SYMATTR Value 560
SYMBOL voltage 752 -304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V11
SYMATTR Value 6
SYMBOL res 1024 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 47
SYMBOL voltage 1168 96 R0
SYMATTR InstName V12
SYMATTR Value -6.5
SYMBOL res 1136 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 47
SYMBOL cap 1008 128 R0
SYMATTR InstName C6
SYMATTR Value 100p
SYMBOL res 896 -112 R0
SYMATTR InstName R21
SYMATTR Value 100
SYMBOL voltage -768 -1072 R0
SYMATTR InstName V13
SYMATTR Value -2
SYMBOL voltage -640 -1072 R0
SYMATTR InstName V5
SYMATTR Value -5.2
TEXT -144 480 Left 2 !.lib LM13700.MOD
TEXT 120 368 Left 2 ;LM13700 Pinout:\n1: Amplifier Bias Input\n2: Diode Bias\n3: Positive Input\n4: Negative Input\n5: Output\n6: Negative Power Supply\n7: Buffer Input\n8: Buffer Output\n11: Positive Power Supply
TEXT -1056 208 Left 2 ;Analog delay
TEXT -144 512 Left 2 !.lib LF347.301
TEXT -256 -1272 Left 2 !.tran 0 3.3u 0 10p
TEXT -1024 -800 Left 2 ;Vpgm = -10.24V -> 0V\nVa_cal = 5.71V + 0.476 * Vpgm\n       = 0.84V -> 5.71V\nVa_adj = -4.5V - Vpmg\n       = 5.74V -> -4.5V
TEXT 328 -688 Left 2 ;Measurement only
TEXT -456 -672 Left 2 ;Va_cal = 0.84V -> 5.71V
TEXT -848 288 Left 2 ;Va_adj = 5.74V -> -4.5V
TEXT -984 360 Left 2 !.step param A_ADJ list 5.7 0 -4.5
