---
layout: post
title: A Varactor-based Clock Skew Tuning Circuit
date:   2025-03-29 00:00:00 -1000
categories:
---

* TOC
{:toc}

# Introduction

The Rohde & Schwarz (R&S) AMIQ vector signal generator has I and Q outputs that must be fed into 
an RF vector signal generator such as the R&S SMIQ. 

To compensate for different propagation delays of the cables between those 2 generators, the AMIQ 
has the ability to introduce a skew of up to 1 ns between the I and Q output, in either direction. 
The skew can be controlled with a precision of 5 ps.

In this blog post, I check out the circuit of the clock skewing circuit, simulate it, and try
to explain how it works.

# System Description 

Without going into too much detail, the AMIQ is an arbitrary waveform generation (AWG) that reads
waveform samples from 2 SDRAMs, sends them to 2 DACs, and passes the resulting analog signal through 
various post-processing stages.

The DACs have a sample rate of maximum 100 Msps, or a clock period of 100ns. 

To control the skew between the 2 analog signals with a precision that is much higher than the clock
period, the logical place to insert this skew is by playing with the clock that goes to the DACs. And
that's exactly how it's done:

![System diagram](/assets/clock_skew/clock_skew_tuning-amiq_system_diagram.svg)

# The Skew Adjust Schematic

Let's check out page 87 of the excellent AMIQ service manual the details of the skew adjust cricuit.

[![Skew adjust schematic](/assets/clock_skew/skew_adj_schematic.png)](/assets/clock_skew/skew_adj_schematic.png)
*(Click to enlarge)*

`DAC_CLK` is the input signal that is driven by a logic gate from the 74ABT series, a family of fast digital
discrete chips that use Advanced BiCMOS technology. It uses 0V to signal a low and 3.4V to signal a high
value. `I_DAC_CLK` and `Q_DAC_CLK` are the output signals that can have some skew between them.

`SKEW_TUNE` is an analog signal that control the skew. It's generated by an 
[Analog Device DAC8143](https://www.analog.com/media/en/technical-documentation/data-sheets/DAC8143.pdf) 
which a resolution of 12 bits followed by some opamps that double the maximum value from 5V to 10V.
According to the datasheet, the skew can be controlled from -1ns to +1ns or a span of 2ns. With the 12-bit DAC, 
the skew can be adjusted in steps of 50ps.

[![SKEW_TUNE DAC](/assets/clock_skew/skew_tune_dac.png)](/assets/clock_skew/skew_tune_dac.png)
*(Click to enlarge)*

It's not immediately clear from the schematic, but the skew between the 2 output signals is created by sending 
the input signal through 2 R/C delay lines with a different capacitance. And these capacitances are created
by a pair of [varactors](https://en.wikipedia.org/wiki/Varicap), also known as varicap diodes.

# 


# References
