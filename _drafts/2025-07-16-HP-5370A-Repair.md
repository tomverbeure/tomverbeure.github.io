---
layout: post
title: Repairing an HP 5370A Time Interval Counter
date:   2025-07-16 00:00:00 -1000
categories:
---

* TOC
{:toc}

# Introduction

I bought an HP 5370A time interval counter at the 
[Silicon Valley Electronics Flea Market](https://www.electronicsfleamarket.com) for
a cheap $40.

![HP 5370A sitting on a desk](/assets/hp5370a/hp5370a_on_desk.jpg)

The 5370A is a pretty popular device among [time nuts](http://leapsecond.com/time-nuts.htm): 
it has a precision of 20ps for single-shot time interval measurements, amazing for a device that was 
released in 1978 and even compared to contemporary time interval counters it's still a decent performance. 
The 74LS chips in mine have a 1981 time code which makes the unit a whopping 44 years old.

But after I plugged it in and pressed the power button, smoke and a horrible smell came out after a 
few minutes.  

I had just purchased myself hours of entertainment!

# Inside the HP 5370A

It's trivial to open the 5370A:

* remove the 4 feet in the back by removing the screw inside them. My unit had regular
  Philips screws.
* remove a screw to release the top or bottom cover

[![HP 5370A top cover removed](/assets/hp5370a/hp5370a_top_cover_removed.jpg)](/assets/hp5370a/hp5370a_top_cover_removed.jpg)
*(Click to enlarge)*

Once inside, you can see an extremely modular build: the center consists of a motherboard 
with 10 plug-in PCBs, 4 on the left for an embedded computer that's based on an MC6800 CPU,
6 on the right for the time acuiqistion.  The top has plug-in PCBs as well, with the power supply on the left
and reference clock circuitry on the right. My unit uses the well known HP 10811-60111
high-stability [OCXO](https://en.wikipedia.org/wiki/Crystal_oven) as 10MHz clock reference. 
The bottom doesn't have plug-in PCBs. It has PCBs for trigger logic and the front panel.

This kind of modular build probably adds significant cost, but it's a dream for servicing 
and tracking down faults. To make things even easier, the vertical PCBs have a plastic ring 
or levers to pull them out of their slot! There are also plenty of generously sized test pins 
and some status LEDs. 

![Plastic pull-ring on PCB](/assets/hp5370a/plastic_pull_ring.jpg)

# High Stability Reference Clock with an HP 10811-60111 OCXO

Since the unit has the high stability option, I have now yet another piece of test equipment
with an HP 10811-60111 OCXO. OCXOs are supposed to be powered on at all time: environmental 
changes tend to stress them out and result in a deviation of their clock speed, which is why 
there's a "24 hour warm-up" sticker on top of the case. It can indeed take quite a while for 
an OCXO to relax and settle back into its normal behavior, though 24 hours seems a bit excessive.

The 5370A has a separate always-on power supply just for the oven of the OCXO to keeps the crystal 
at constant temperature, even when the power switch on the front is not in the ON position. Luckily, 
the fan is powered off when the front switch is set to stand-by.[^hp8656a]

[^hp8656a]: My HP 8656A RF signal generator has an OCXO as well. But the fan keeps running
      even when it's in stand-by mode, and the default fan is very loud too!

![Main power regulator, OCXO, OCXO power regulator and clock circuit](/assets/hp5370a/power_controller_and_ref_clock.jpg)

In the image above, from top to bottom, you can see:

* the main power supply control PCB
* the HP 10811-60111 OCXO. To the right of it is the main power relay.
* the OCXO oven power supply
* the reference frequency buffer PCB

These are the items that will play the biggest role during the repair.

# RIFA Capacitors in the Corcom F2058 Power Entry Module?

After plugging in the 5370A the first time, magic smoke came out of it along with a pretty
disgusting chemical smell, one that I already knew from some work that I did on an
HP 8656A RF signal generator. 

I unplugged the power, opened up the case, and looked for burnt components but couldn't
find any. After a while, I decided to power the unit back on and... nothing. No smoke,
no additional foul smell, but also no display.

One of common failure mode of test equipment from way back when are RIFA capacitors that sit 
right next to the mains power input, *before* any kind of power switch. Their primary function
is to filter out high frequency noise that's coming from the device and reduce EMI.
RIFAs have a well known tendency to crack over time and eventually catch fire. A couple of years ago, I
[replaced the RIFA capacitors of my HP 3457A](/2022/12/02/HP3478A-Multimeter-Calibration-Data-Backup-and-Battery-Replacement.html#replacing-the-capacitors),
but a general advice is to inspect all old equipment for these gold colored capacitors. However,
no such discrete capacitors could be found.

![Corcom F2058 line power module](/assets/hp5370a/Corcom_F2058.jpg)

But that doesn't mean they are not there: like a lot of older HP test equipment, the 5370A uses 
a Corcom F2058 line power module that has capacitors embedded inside.

Below is the schematic of the Corcom F2058 (HP part number 0960-0443). The capacitors are marked
in red. You can also see a fuse F1, a transformer and, on the right, a selector that can be used
to configure the device for 100V, 115V/120V, 220V and 230V/240V operation. 

[![Corcom F0258 schematic](/assets/hp5370a/Corcom_F2058_schematic.jpg)](/assets/hp5370a/Corcom_F2058_schematic.jpg)
*(Click to enlarge)*

There was a bad smell lingering around the Corcom module, so I removed it to check it out. There
are metal clips on the left and right side that you need to push in to get the module out. It
takes a bit of wiggling, but it works out eventually. Once removed, however, the Corcom didn't
really have a strong smell at all. I couldn't find any strong evidence online that these modules
have RIFAs inside them, so for now, my conclusion is that they don't have them and that there's
no need to replace them.

**Module replacement**

In the unlikely case that you want to replace the Corcom module, you can use this
$20
[AC Power Entry Module](https://www.mouser.com/ProductDetail/Astrodyne-TDI/082SM.00300.00?qs=eP2BKZSCXI7mqcKDec2Dzg%3D%3D)
from Mouser. One reason why you might want to do this is because the new module has a built-in
power switch. If you use an external 10 MHz clock reference instead of the 10811 OCXO, then 
there's really no need to keep the 5370A connected to the main all the time.

There are two caveats, however:

* while it has the same dimensions as the Corcom F2058, the power terminals are located at the very back,
  not in an indented space. This is not a problem for the 5370A, which still has enough room for both, but 
  it doesn't work for most other HP devices that don't have an oversized case. You can see that in the
  picture below:

  ![Corcom and replacement AC Power Entry Module](/assets/hp5370a/corcom_mains_input_blocks.jpg)

* Unlike the Corcom F2058, the replacement only feeds through power, neutral and ground that's fed into it. 
  You'd have to choose one configuration, 120V in my case, and wire a bunch of wires together to drive the 
  transformer correctly. If you do this wrong, the input voltage to the power regulator will either be too low, 
  and it wont work, or too high, and you might blow up the power regulation transistors. It's not super 
  complicated, but you need to know what you're doing.

# 15V Rail Issues

After plugging the unit back in, it still didn't work, but thanks to the 4 power rail status LEDs, it 
was immediately obvious that +15V power rail had issues. 

![4 status LEDs on the power controller PCB. The left one is off](/assets/hp5370a/status_leds.jpg)

A close-by PCB is the reference frequency buffer PCB. It has a "10 MHz present" status
LED that didn't light up either, suggesting an issue with the 10811 OCXO, but I soon figured
out that this status LED relies on the presence of the 15V rail.

# Power Suppy Architecture

The 5370A was first released in 1978, decades before HP decided to stop including detailed
schematics in their service manuals. Until Keysight, the Company Formerly Known as HP, decides
to change its name again, you can download the operating and service manual
[here](https://www.keysight.com/us/en/assets/9018-06037/user-manuals/9018-06037.pdf). If you
need a higher quality scan, you can also purchase the manual for $10 from 
[ArtekManuals](https://artekmanuals.com/)[^artek].

[^artek]: Don't expect to be able to cut-and-paste text from the ArtekManuals scans, because they have
      some obnoxious rights managment that prevents this.

The power supply architecture is straightforward: the line transformer has 5 separate windings,
4 for the main power supply and 1 for the always-on OCXO power supply. A relay is used to
disconnect the 4 unregulated DC rails from the power regulators when the front power button is in stand-by 
position, but the diode rectification bridge and the *gigantic* smoothing capacitors are located before
the relay.[^bleeding_resistor]

[^bleeding_resistor]: Each smoothing capacitor has a bleeding resistor in parallel to discharge the capacitors
      when the power cable is unplugged. But these resistors will leak power even when the
      unit is switched off. EnergyStar regulations clearly weren't a thing back in 1978.

For each of the 4 main power rails, a discrete linear voltage regulator is built
around a power transistor, LM307AN opamps and a smaller transistor for over-current protection.
There's also a fuse at the input of each regulator. The 4 regulators share a 10V voltage reference.

The opamps and the voltage reference are powered by a simple +16.2V power rail built out of
a resistor and a Zener diode.

The power regulators for the +5V and -5.2V rails have a current sense resistor of 0.07 Ohm. The
sense resistors for the +15V and -15V rails haver a value of 0.4 Ohm. When the voltage across
these resistors exceeds the 0.7V base-emitter potential of the bipolar transistors cross them,
the transistors start to conduct and pull down the base-emitter voltage of the power transistor,
thus shutting them off.

Using the value of 0.4 Ohm, 0.07 Ohm and 0.7V, we can estimate that the power regulators
enter current control (and reduce the output voltage) when the current exceeds 10A for the 
+5/-5.2V rails and 1.5A for the +15/-15V rails. This more or less matches the value of the fuses, 
which are specified at 7A and 1.5A respectively.

# Fault Isolation - It's the Reference Frequency Buffer PCB!

I measured a voltage of 8V instead of 15V. I would have prefered if I had measured no voltage at all, 
because a lower than expected voltage suggests that the power regulator is in current control instead 
of voltage control mode. In other words: there's a short somewhere which results in a current that exceeds 
what's expected under normal working conditions. Such a short can be located anywhere.

But this is where the modular design of the 5370A shines: you can unplug all the PCBs, check the
the 15V rails, and if it's fine, add back PCBs until it's dead again. And, indeed, with all the
PCBs removed, the 15V rail worked fine. I first added the CPU related PCBs, then the time acquisition
PCBs, and the 15V was still fine. But after plugging in the reference frequency buffer PCB, the
15V LED went off and I measured 8V again. Of all the PCBs, this is the easiest one to understand.

# The Reference Frequency Buffer Board

The reference frequency buffer board has the following functionality:

* Convert the internally generated 10MHz frequency to 
  [emitter-coupled logic levels (ECL)](https://en.wikipedia.org/wiki/Emitter-coupled_logic).

  A cheaper version of the 5370A didn't come with an OCXO, but with a lower performance
  crystal oscillator. These units were usually deployed in labs that have an external
  reference clock.

* Receive an external reference clock of 5 MHz or 10 MHz, multiply by 2 in the case of
  5 MHz, and apply a 10 MHz filter. Convert to ECL as well.

* Create the final reference clock, select between internal and external clock.

* Send final reference clock out as ECL (time measurement logic), TTL (CPU) and 
  sine wave (reference-out connector on the back panel).

One thing that had bothered me all along was why the front-panel display had remained off when all
CPU board were plugged in. Unlike later HP test equipment like the HP 5334A universal counter, the
CPU clock of the 5370A is derived from the 10 MHz clock that comes out of this reference frequency 
buffer PCB.[^div8] If that board is broken, nothing will work.

[^div8]: The CPU runs at 1.25 MHz, the 10 MHz divided by 8.


# Debugging

* 15V sometimes 8V, sometimes ~0V
* When unplugging the ref clock board: 
    * power always remains at 15V
    * connector pin 14_ of ref clock board has a 10 MHz clock
* 15V is only used for external clock circuit
* Desolder R16, 3.6 Ohm (10 Ohm in schematic) resistor that links
  connector 15V to internal 15V so that 15V is completely removed from ref clock board.
* After this:
    * 10 MHz (ECL) on INT clock test point
    * 15V rail still sold at 8V
* Only remaining path tou ground is 10uF capacitor C17 (marked 25+ -> 25V?)
    * It's burnt crisp!
    * Remove -> 15V stays on
* Still no display...
    * No clock on CLK testpoint of CPU board A9
    * This is a 10MHz that is derived from a clock that goes from the ref clock board
    * This clock requires 15V
* Add electrolytic 10uF cap and put resistor R16 back
    * After this, R16 burns up!



# Corcom

* A: orange *
* B: red, connected to Corcom N
* H: silver, connect to Corom L  (are red and silver swapped?)
* C: white/red/orange -> goes to fan 
* C: black *
* D: black/green *
* E: black/yellow *
* E: white/brown/orange -> goes to fan
* F: black/red *




# References
